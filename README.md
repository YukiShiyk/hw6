# 数字图像处理第六次作业
## 自动化66 史玉康
## 2161800034

**摘要**

图像的退化与复原是图像处理的重要分支，处理目标是改善图像，以达到显示或后续处理的某种需求。本文首先讨论图像退化与复原的一般化模型，在此基础上对图像的噪声退化和运动模糊进行具体实现，并选择不同参数以便于讨论各参数的具体作用。

**背景知识简介**

图像恢复技术是图像处理领域一类重要的处理技术，与图像增强等其他基本图像处理技术类似，该技术也是以改善图像视觉质量为目的，所不同的是图像恢复过程需要根据指定的图像退化模型来完成。从该退化模型出发，对在某种情况下退化了的图像进行恢复，以获取未经退化的原始图像。换句话说，图像恢复的处理过程实际是对退化图像品质的提升，并通过图像品质的提升来达到图像在视觉上的改善。一般地，图像的退化模型可以表述为

#### g(x,y)=h(x,y)*f(x,y)+n(x,y)


其中g(x,y)表示表示退化之后的图像，ℎ(𝑥,𝑦)表示退化函数，f(𝑥,𝑦)表示原始图像，𝑛(𝑥,𝑦)表示加性噪声。在空域图像的退化过程是通过与退化函数的卷积和与加性噪声的叠加实现的，若对上式两端同时进行傅里叶变换，那么退化过程的频域表示为

#### G(u,v)=H(u,v)F(u,v)+N(u,v)

在此退化模型的基础上对进行图像恢复，只需在输出后添加一个复原滤波器即可。图像地退化与复原既可以在空域进行，也可以在频域进行，但一般而言在频域进行要相对方便，本文地后续讨论均在频域进行。

### 1、在测试图像上产生高斯噪声lena图-需能指定均值和方差；并用多种滤波器恢复图像，分析各自优缺点；

**分析**

高斯噪声是指它的概率密度函数服从高斯分布（即正态分布）的一类噪声。常见的高斯噪声包括起伏噪声、宇宙噪声、热噪声和散粒噪声等等。除常用抑制噪声的方法外，对高斯噪声的抑制方法常常采用数理统计方法。如果一个噪声，它的幅度分布服从高斯分布，而它的功率谱密度又是均匀分布的，则称它为高斯白噪声。高斯白噪声的二阶矩不相关，一阶矩为常数，是指先后信号在时间上的相关性。高斯白噪声包括热噪声和散粒噪声。
高斯噪声出现在图像的每一个点上，而值的大小却是随机的。

**处理结果**

高斯函数加噪声后的处理结果如下所示（均值50，方差20）：

利用OpenCV自带的平滑函数对加噪后的图像进行平滑处理，各种滤波函数处理后的结果如下图所示：

**结果分析**

观察以上实验结果可以发现，添加高斯噪声后，图像各个区域出现了许多噪声点，表现为区别于背景的或白或黑的细小噪点，这使得图像的显示质量下降。此外，添加噪声后的退化图像的亮度要高于原始图像，这是由于噪声参数造成的，由于所添加的噪声均值是50，而不是零，因此整体上相当于给图像添加了一个正灰度分量，如果噪声均值改为0，那么图像的整体亮度则不会改变。本文之所以选取50作为噪声均值，是为了方便观察退化效果。

在本文涉及的四种复原方法中，中值滤波、均值滤波、高斯空域模糊都属于空域模糊处理，高斯低通滤波器属于频域处理。对比四种复原手段，其效果大同小异，都在去除了部分噪声的同时，一定程度上模糊了图像。综合比较去噪效果和模糊损失，效果最好的复原方法是空域高斯平滑模板，因为噪声在空域添加，而高斯模板在空域又具备高斯函数的起伏特征，起到了保留大部分原始像素值和抑制大部分噪声值得作用。这些复原手段严格来说是不理想的，理想效果应是能近似得到原始图像。


经过高斯噪声用均值滤波比较好。

原因是：
     1.高斯噪声的幅值近似正态分布，但是分布在每个点上。
     2.因为所有的点都被污染所以不能中值滤波选不到正确的干净的点。
     3.因为高斯噪声服从正态分布所以均值噪声为零可以选用均值滤波处理噪声。
    
### 2、在测试图像lena图加入椒盐噪声（椒和盐噪声密度均是0.1）；用学过的滤波器恢复图像；在使用反谐波分析Q大于0和小于0的作用；

**分析**

椒盐噪声（salt-and-pepper noise)又称脉冲噪声，它随机改变一些像素值，在二值图像上表现为使一些像素点变白，一些像素点变黑。椒盐噪声是指两种噪声，一种是盐噪声（salt noise），另一种是胡椒噪声（pepper noise）。盐=白色，椒=黑色。前者是高灰度噪声，后者属于低灰度噪声。一般两种噪声同时出现，呈现在图像上就是黑白杂点。椒盐噪声的出现点是随机的，噪声的数值是固定的，要么是 0 （黑色），要么是 255 （白色）。

**处理结果**

**结果分析**

对比几组滤波器的处理效果，发现中值滤波对椒盐噪声的处理效果最好。

### 3、推导维纳滤波器并实现下边要求；


####  问题分析

维纳滤波器的推导：

在数学应用上，对于运动引起的图像模糊，最简单的方法是直接做逆滤波，但是逆滤波对加性噪声特别敏感，使得恢复的图像几乎不可用。最小均方差（维纳）滤波用来去除含有噪声的模糊图像，其目标是找到未污染图像的一个估计，使它们之间的均方差最小，可以去除噪声，同时清晰化模糊图像。

定义
给定一个系统 
y(t)=h(t)∗x(t)+n(t)，这里，∗是卷积符号
x(t)是在时间t刻输入的信号（未知）
h(t)是一个线性时间不变系统的脉冲响应（已知）
n(t)是加性噪声，与x(t)不相关（未知）
y(t)是我们观察到的信号 

我们的目标是找出这样的卷积函数g(t)，这样我们可以如下得到估计的x(t)： 
x^(t)=g(t)∗y(t)

这里x^(t)是x(t)的最小均方差估计。 
基于这种误差度量， 滤波器可以在频率域如下描述 
G(f)=H∗(f)S(f)|H(f)|2S(f)+N(f)=H∗(f)|H(f)|2+N(f)/S(f)

这里：
G(f)和H(f)是g和h在频率域f的傅里叶变换。
S(f)是输入信号x(t)的功率谱。
N(f)是噪声的n(t)的功率谱。
上标∗代表复数共轭。 
滤波过程可以在频率域完成： 
X^(f)=G(f)∗Y(f)

这里 X^(f)是 x^(t)的傅里叶变换，通过逆傅里叶变化可以得到去卷积后的结果x^(t)。
解释
上面的式子可以改写成更为清晰的形式 
G(f)=1H(f)⎡⎣⎢|H(f)|2|H(f)|2+N(f)S(f)⎤⎦⎥=1H(f)⎡⎣⎢|H(f)|2|H(f)|2+1SNR(f)⎤⎦⎥


这里HH(f)是h在频率域f的傅里叶变换。SNR(f)=S(f)/N(f)是信号噪声比。当噪声为零时（即信噪比趋近于无穷），方括号内各项也就等于1，意味着此时刻维纳滤波也就简化成逆滤波过程。但是当噪声增加时，信噪比降低，方括号里面值也跟着降低。这说明，维纳滤波的带通频率依赖于信噪比。
推导
上面直接给出了维纳滤波的表达式，接下来介绍推导过程。 
上面提到，维纳滤波是建立在最小均方差，可以如下表示： 
e(f)=E|X(f)−X^(f)|2

这里E是期望 
如果我们替换表达式中的X^(f)，上面可以重新组合成 
e(f)=E|X(f)−G(f)Y(f)|2=E|X(f)−G(f)[H(f)X(f)+V(f)]|2=E|[1−G(f)H(f)]X(f)−G(f)V(f)|2


展开二次方，得到下式： 
e(f)=[1−G(f)H(f)][1−G(f)H(f)]∗E|X(f)|2−[1−G(f)H(f)]G∗(f)E{X(f)V∗(f)}−G(f)[1−G(f)H(f)]∗E{V(f)X∗(f)}+G(f)G∗(f)E|V(f)|2


然而，我们假设噪声与信号独立无关，这样有 
E{X(f)V∗(f)}=E{V(f)X∗(f)}=0


并且我们如下定义功率谱 
S(f)=E|X(f)|2N(f)=E|V(f)|2


这样我们有 
e(f)=[1−G(f)H(f)][1−G(f)H(f)]∗S(f)+G(f)G∗(f)N(f)


为了得到最小值，我们对G(f)G(f)求导，令方程等于零。 
d(f)dG(f)=G∗(f)N(f)−H(f)[1−G(f)H(f)]∗S(f)=0


由此最终推出维纳滤波器。

#### 处理结果

**(a) 实现模糊滤波器如方程Eq. (5.6-11)**

模糊滤波器的频域表达式为：

![](http://chart.googleapis.com/chart?cht=tx&chl=\Large x=\frac{-b\pm\sqrt{b^2-4ac}}{2a})

实现该滤波器只需先将输入图像进行傅里叶变换并移至图像中心，之后将图像的傅里叶变换和模糊滤波器的傅里叶变换进行队列相乘，将得到的结果经过傅里叶反变换返回到空间域即可实现该滤波器。

**(b) 模糊lena图像：45度方向，T=1**

处理结果如下所示：

**(c) 再模糊的lena图像中增加高斯噪声，均值= 0 ，方差=10 pixels 以产生模糊图像**
**(d)分别利用方程 Eq. (5.8-6)和(5.9-4)，恢复图像；并分析算法的优缺点**






